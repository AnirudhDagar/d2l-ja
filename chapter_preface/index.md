# 序文

ほんの数年前、大手企業や新興企業でインテリジェントな製品やサービスを開発しているディープラーニングの科学者はほとんどいませんでした。私たちがこの分野に参入したとき、機械学習は日刊紙の見出しにはなりませんでした。私たちの両親は機械学習が何であるかを知りませんでした。言うまでもなく、私たちが医学や法律のキャリアよりも機械学習を好む理由は言うまでもありません。機械学習は青空の学問分野であり、その産業上の意義は、音声認識やコンピュータービジョンなど、現実世界のごく一部のアプリケーションに限られていました。さらに、これらのアプリケーションの多くは非常に多くのドメイン知識を必要とするため、機械学習が1つの小さなコンポーネントである完全に独立した領域と見なされることが多かった。当時、本書で取り上げるディープラーニング手法の前身であるニューラルネットワークは、一般的に時代遅れと見なされていました。 

過去5年間で、ディープラーニングは世界を驚かせ、コンピュータビジョン、自然言語処理、自動音声認識、強化学習、生物医学情報学などの多様な分野で急速な進歩を後押ししました。さらに、実際に関心のある多くのタスクでディープラーニングが成功したことで、理論的な機械学習や統計学の発展が促進されました。これらの進歩により、かつてないほど自律性（および一部の企業が信じているよりも自律性が低い）で自走する車、最もありふれた電子メールを自動的にドラフトするスマートリプライシステム、人々が圧倒的に大きな受信トレイから掘り出すのを支援するスマートリプライシステム、およびソフトウェアを構築できるようになりました。ゴーのようなボードゲームで世界最高の人間を支配するエージェントは、かつて数十年先にあると考えられていた偉業です。すでに、これらのツールは産業や社会にますます大きな影響を及ぼし、映画の制作方法や病気の診断方法を変え、天体物理学から生物学に至る基礎科学においてますます大きな役割を果たしています。 

## この本について

この本は、ディープラーニングを親しみやすくするための私たちの試みを表しており、*概念*、*コンテキスト*、*コード*を教えています。 

### コード、数学、HTMLを組み合わせた1つの媒体

コンピューティングテクノロジが最大限の効果を発揮するには、そのテクノロジを十分に理解し、十分に文書化して、十分に管理された成熟したツールでサポートする必要があります。重要なアイデアは明確に抽出され、新しい開業医を最新の状態にするために必要なオンボーディング時間を最小限に抑える必要があります。成熟したライブラリは一般的なタスクを自動化するべきであり、模範的なコードは、実践者が自分のニーズに合わせて共通のアプリケーションを簡単に変更、適用、拡張できるようにすべきです。動的な Web アプリケーションを例に挙げてみましょう。Amazonのように多くの企業が1990年代にデータベース駆動型のウェブアプリケーションを開発してきたにもかかわらず、このテクノロジーがクリエイティブな起業家を支援する可能性は、過去10年間で大幅に実現されました。その一因は、強力で十分に文書化されたフレームワーク。 

ディープラーニングの可能性のテストには特有の課題があります。どのアプリケーションでもさまざまな分野が統合されるからです。ディープラーニングを適用するには、(i) 特定の方法で問題を投げかける動機、(ii) 与えられたモデルの数学的形式、(iii) モデルをデータにあてはめるための最適化アルゴリズム、(iv) モデルをいつ期待すべきかを示す統計的原理を同時に理解する必要がある目に見えないデータと、それらが実際に一般化されていることを証明するための実用的な方法に一般化する。(v) モデルを効率的にトレーニングし、数値計算の落とし穴を乗り越え、利用可能なハードウェアを最大限に活用するために必要なエンジニアリング手法。問題を定式化するために必要な批判的思考スキル、問題を解くための数学、それらのソリューションを実装するためのソフトウェアツールの両方を1か所で教えることは、非常に困難な課題です。この本での私たちの目標は、開業医になる可能性のある人をスピードアップするための統一されたリソースを提示することです。 

私たちがこの本のプロジェクトを始めたとき、（i）最新のもの、（ii）技術的な深さで現代の機械学習の全範囲を網羅したもの、（iii）魅力的な教科書に期待される品質を、クリーンで実行可能なコードでインターリーブされた説明と同時に、リソースはありませんでした。はハンズオンチュートリアルで見つかることを期待しています。特定のディープラーニングフレームワークの使い方 (TensorFlow で行列を使って基本的な数値計算を行う方法など) や、特定のテクニック (LeNet、AlexNet、ResNetsなどのコードスニペットなど) を実装するためのコード例が、さまざまなブログ投稿や GitHub リポジトリに散らばっていました。ただし、これらの例では通常
*与えられたアプローチをどのように実装するか
しかし、の議論は省きました 
*なぜ* 特定のアルゴリズムによる決定がなされるのか
Web サイト [Distill](http://distill.pub) で公開された魅力的なブログ投稿や個人ブログなど、特定のトピックに対応するために一部のインタラクティブなリソースが散発的に出現しましたが、ディープラーニングでは選択されたトピックのみを取り上げ、関連するコードがないことが多々ありました。一方、ディープラーニングの基礎に関する包括的な調査を提供する :cite:`Goodfellow.Bengio.Courville.2016` など、ディープラーニングの教科書がいくつか登場しましたが、これらのリソースは記述とコード内の概念の実現を結びつけるものではなく、読者がそれらをどのように実装するのか分からないままになることがあります。さらに、商用コースプロバイダのペイウォールの背後に隠されているリソースが多すぎます。 

私たちは、(i) すべての人が自由に利用できる、(ii) 実際に機械学習の応用科学者になるための出発点を提供するのに十分な技術的深みを提供する、(iii) 読者に見せる実行可能なコードを含めることができるリソースの作成に着手しました。
*実際に問題を解決する方法*
(iv) 当社およびコミュニティ全体による迅速な更新を可能にし、(v) 技術的な詳細について対話的に議論し、質問に答えるために [forum](http://discuss.d2l.ai) を補完する。 

これらの目標はしばしば矛盾していました。方程式、定理、引用は、LaTeXで最もよく管理され、配置されます。コードは Python で最もよく記述されます。また、ウェブページはHTMLとJavaScriptでネイティブです。さらに、コンテンツは、実行可能なコード、物理的な本、ダウンロード可能なPDF、およびインターネット上で Web サイトとしてアクセスできるようにしたいと考えています。現在、これらの要求にぴったり合ったツールやワークフローは存在しないため、自社で組み立てる必要がありました。このアプローチについては :numref:`sec_how_to_contribute` で詳しく説明しています。ソースを共有し、コミュニティへの貢献を促進するために GitHub、コード、方程式、テキストを混合するための Jupyter ノートブック、複数の出力を生成するレンダリングエンジンとしてのスフィンクス、フォーラムの Discourse に取り組みました。私たちのシステムはまだ完璧ではありませんが、これらの選択は競合する懸念の中で良い妥協点を提供します。このような統合ワークフローを使って出版された本は、これが初めてかもしれないと私たちは考えています。 

### やることによる学習

多くの教科書は概念を連続して提示し、それぞれを網羅的に詳しく説明しています。たとえば、Chris Bishopの優れた教科書 :cite:`Bishop.2006` は、各トピックを徹底的に教えているため、線形回帰の章に入るには些細な作業が必要です。専門家はこの本を徹底的に愛していますが、真の初心者にとっては、この特性は導入テキストとしての有用性を制限します。 

この本では、ほとんどの概念を*ジャストインタイム*で教えます。言い換えれば、実用的な目的を達成するために必要な概念をすぐに学ぶことができます。最初は、線形代数や確率などの基本的な予備を教えるのに少し時間がかかりますが、より難解な確率分布について心配する前に、最初のモデルをトレーニングした満足感を味わってほしい。 

基本的な数学的背景についての短期集中コースを提供する予備的なノートブックの他に、以降の各章では、妥当な数の新しい概念と、実際のデータセットを使用した単一の自己完結型の作業例の両方を紹介します。これは組織的な課題です。モデルによっては、論理的に 1 つのノートブックにまとめられている場合があります。また、いくつかのモデルを連続して実行することで最も効果的なアイデアもあります。一方、*1つの実例、1つのノートブック*というポリシーに従うことには大きな利点があります。これにより、私たちのコードを活用して、自分の研究プロジェクトをできるだけ簡単に始めることができます。ノートブックをコピーして修正を開始するだけです。 

必要に応じて、実行可能なコードをバックグラウンドマテリアルとインターリーブします。一般的に、ツールを完全に説明する前に、ツールを利用可能にするという誤りを犯すことがよくあります (その背景については後で説明します)。例えば、*確率的勾配降下法* を使うと、なぜそれが役に立つのか、なぜ機能するのかを完全に説明することができます。これは、問題を迅速に解決するために必要な弾薬を実践者に提供するのに役立ちますが、読者に学芸員の決定を信頼してもらうことを犠牲にします。 

この本は、ディープラーニングの概念をゼロから教えます。ディープラーニングフレームワークの高度な抽象化によってユーザーには見えないモデルの詳細を掘り下げたい場合があります。これは特に、特定のレイヤーまたはオプティマイザーで発生するすべてのことを理解してもらいたい基本的なチュートリアルで取り上げられます。このような場合、2つのバージョンの例を挙げます。1つは、Numpyライクな機能と自動微分のみに依存してすべてをゼロから実装するバージョンと、ディープラーニングフレームワークの高レベル API を使用して簡潔なコードを記述するより実用的な例です。コンポーネントがどのように機能するかを説明したら、以降のチュートリアルで高レベル API を使用できます。 

### コンテンツと構造

本書は、予習、ディープラーニング手法、実際のシステムとアプリケーションに焦点を当てた高度なトピックに焦点を当て、大きく3つのパートに分けることができます (:numref:`fig_book_org`)。 

![Book structure](../img/book-org.svg)
:label:`fig_book_org`

* 最初のパートでは、基本と予習について説明します。
:numref:`chap_introduction` では、ディープラーニングの概要を説明しています。その後、:numref:`chap_preliminaries` では、データを格納して操作する方法や、線形代数、微積分、確率などの基本概念に基づいたさまざまな数値演算を適用する方法など、実践的なディープラーニングに必要な前提条件について簡単に説明します。:numref:`chap_linear` と :numref:`chap_perceptrons` が最も多くカバーしています。回帰と分類、線形モデルと多層パーセプトロン、過適合と正則化など、ディープラーニングの基本的な概念と手法。 

* 次の 5 つの章では、最新のディープラーニング手法に焦点を当てます。
:numref:`chap_computation` は、ディープラーニングシステムの主要な計算コンポーネントについて説明し、より複雑なモデルのその後の実装の基礎を築きます。次に、:numref:`chap_cnn` と :numref:`chap_modern_cnn` では、ほとんどの最新のコンピュータービジョンシステムのバックボーンを形成する強力なツールである畳み込みニューラルネットワーク (CNN) を紹介します。同様に、:numref:`chap_rnn` と :numref:`chap_modern_rnn` ではリカレントニューラルネットワーク (RNN) が導入されています。RNN は、データのシーケンシャル (例:時間) 構造を利用するモデルで、自然言語処理や時系列予測に一般的に使用されています。:numref:`chap_attention` では、ほとんどの自然言語処理タスクの主要なアーキテクチャとして RNN に取って代わった、いわゆるアテンションメカニズムに基づく比較的新しいクラスのモデルを導入しました。これらのセクションでは、ディープラーニングの実践者が広く使用している最も強力で一般的なツールについて解説します。 

* 第 3 部では、スケーラビリティ、効率性、アプリケーションについて説明します。
まず、:numref:`chap_optimization` で、ディープラーニングモデルの学習に使用される一般的な最適化アルゴリズムをいくつか取り上げます。次の章 :numref:`chap_performance` では、ディープラーニングコードの計算パフォーマンスに影響するいくつかの重要な要素について説明します。:numref:`chap_cv` では、コンピュータービジョンにおけるディープラーニングの主な応用例を示しています。:numref:`chap_nlp_pretrain` と :numref:`chap_nlp_app` では、言語表現モデルを事前トレーニングし、自然言語処理タスクに適用する方法を示します。 

### コード
:label:`sec_code`

このマニュアルのほとんどのセクションでは、実行可能コードを取り上げています。いくつかの直感は、試行錯誤しながらコードを微調整し、結果を観察することによって最もよく発達すると信じています。理想的には、洗練された数学的理論が、望ましい結果を得るためにコードを微調整する方法を正確に教えてくれるかもしれません。しかし、今日のディープラーニングの実践者は、説得力のある理論では確固たるガイダンスを提供できない場所を踏まなければならないことがよくあります。私たちの最善の試みにもかかわらず、これらのモデルを特徴付ける数学が非常に難しい場合と、これらのトピックに関する真剣な調査が最近になってハイギアになったばかりであるため、さまざまな技術の有効性に関する正式な説明はまだ欠けています。ディープラーニングの理論が進歩するにつれて、この本の将来の版が、現在入手可能なものを凌駕する洞察を提供できることを期待しています。 

不要な繰り返しを避けるため、最も頻繁にインポートされ、参照される関数とクラスの一部を `d2l` パッケージにカプセル化します。関数、クラス、import ステートメントのコレクションなど、あとで `d2l` パッケージを介してアクセスされるコードブロックを示すために、`# @save `でマークします。:numref:`sec_d2l` には、これらの関数とクラスの詳細な概要が記載されています。`d2l` パッケージは軽量で、必要なのは次の依存関係のみです。

```{.python .input}
#@tab all
#@save
import collections
from collections import defaultdict
from IPython import display
import math
from matplotlib import pyplot as plt
import os
import pandas as pd
import random
import re
import shutil
import sys
import tarfile
import time
import requests
import zipfile
import hashlib
d2l = sys.modules[__name__]
```

:begin_tab:`mxnet`
この本のコードのほとんどは、深層学習のためのオープンソースフレームワークである Apache MXNet に基づいています。Apache MXNet は、AWS（アマゾンウェブサービス）だけでなく、多くの大学や企業でも好まれています。本書のすべてのコードは、最新の MXNet バージョンでのテストに合格しています。ただし、ディープラーニングの急速な発展により、MXNet の将来のバージョンでは、*Print Edition* の一部のコードが正しく動作しなくなる可能性があります。オンライン版は最新の状態に保つ予定です。問題が発生した場合は、:ref:`chap_installation` を参照してコードとランタイム環境を更新してください。 

MXNet からモジュールをインポートする方法は次のとおりです。
:end_tab:

:begin_tab:`pytorch`
この本のコードのほとんどは PyTorch をベースにしています。PyTorch は、ディープラーニングの研究コミュニティに熱狂的に受け入れられている非常に人気のあるオープンソースフレームワークです。本書のすべてのコードは PyTorch の最新安定版でのテストに合格しています。ただし、ディープラーニングの急速な発展により、PyTorch の将来のバージョンでは、*印刷版* の一部のコードが適切に動作しなくなる可能性があります。オンライン版は最新の状態に保つ予定です。問題が発生した場合は、:ref:`chap_installation` を参照してコードとランタイム環境を更新してください。 

PyTorch からモジュールをインポートする方法は次のとおりです。
:end_tab:

:begin_tab:`tensorflow`
本書のコードのほとんどは、業界で広く採用され、研究者の間で人気があるディープラーニング用のオープンソースフレームワークである TensorFlow をベースにしています。本書のすべてのコードは、最新の安定版 TensorFlow でのテストに合格しています。ただし、ディープラーニングの急速な発展により、*印刷版* の一部のコードは TensorFlow の将来のバージョンでは正しく動作しない可能性があります。オンライン版は最新の状態に保つ予定です。問題が発生した場合は、:ref:`chap_installation` を参照してコードとランタイム環境を更新してください。 

TensorFlow からモジュールをインポートする方法は次のとおりです。
:end_tab:

```{.python .input}
#@save
from mxnet import autograd, context, gluon, image, init, np, npx
from mxnet.gluon import nn, rnn
```

```{.python .input}
#@tab pytorch
#@save
import numpy as np
import torch
import torchvision
from torch import nn
from torch.nn import functional as F
from torch.utils import data
from torchvision import transforms
from PIL import Image
```

```{.python .input}
#@tab tensorflow
#@save
import numpy as np
import tensorflow as tf
```

### 対象読者

本書は、ディープラーニングの実践的手法をしっかりと理解しようとする学生（学部生または大学院生）、エンジニア、研究者を対象としています。すべての概念をゼロから説明するため、ディープラーニングや機械学習の経験は必要ありません。ディープラーニングの方法を完全に説明するには、ある程度の数学とプログラミングが必要ですが、ここでは、ある程度の量の線形代数、微積分、確率、Python プログラミングなど、いくつかの基本を習得することを前提としています。基本を忘れた場合に備えて、付録では、この本にあるほとんどの数学について復習しています。ほとんどの場合、数学的な厳密さよりも直感とアイデアを優先します。私たちの本を理解するための前提条件を超えてこれらの基礎を拡張したい場合は、他の素晴らしいリソースを喜んでお勧めします。Bela Bollobas :cite:`Bollobas.1999`による線形解析は、線形代数と関数解析を非常に深くカバーしています。統計:cite:`Wasserman.2013`のすべては、統計のすばらしい入門書を提供します。ジョー・ブリッツスタインの確率と推論に関する[books](https://www.amazon.com/Introduction-Probability-Chapman-Statistical-Science/dp/1138369918)と[courses](https://projects.iq.harvard.edu/stat110/home)は教育学的な逸品です。もし、もし Python を前に使ったことがないなら、この [Python tutorial](http://learnpython.org/) を熟読したくなるかもしれません。 

### フォーラム

この本に関連して、[discuss.d2l.ai](https://discuss.d2l.ai/) にあるディスカッションフォーラムを立ち上げました。本書のいずれかのセクションについて質問がある場合は、各ノートブックの末尾に、関連するディスカッションページへのリンクがあります。 

## 謝辞

英語と中国語の草稿の何百人もの貢献者に感謝しています。彼らはコンテンツの改善に役立ち、貴重なフィードバックを提供しました。具体的には、この英語ドラフトの貢献者全員が、皆のためにより良いものにしてくれたことに感謝します。GitHub の ID または名前は (順不同): alxnorden, avinashingit, bowen0701, brettkoonce, チャイタニャ・プラカシュ・バパット, cryptonaut, ダヴィデ・フィオッコ, edgarroman, gkutiel, ジョン・ミトロ, リャンプー, ラフル・アガルワル, モハメド・アリ・ジャモウイ, マイケル (ステュー)）スチュワート、マイク・ミュラー、nRauschmayr、Prakhar Srivastav、sad-、シュルミジェ、シェン・ザー、sundeepteki、topecongiro、tpdi、春雨、ヴィシャール・カプール、ヴィシェッシュ・ラヴィ・シュリマリ、YayaB、YaYab、Yuhong Chen、エフゲニー・スミルノフ、lgov、Simon Corston-Oliver、イゴール・ドレエフ、ハン・グエン、pmuens、Andrei Lukovenko、senorcinco、vdev-5、甘い、モハマド・マハディ・ラヒミ、アビシェク・グプタ、USD、domMm、リサオークリー、ボーウェン・リー、オーラッシュ・アフジャ、プラサント・ブッダレッディガリ、brianhendee、mani2106、mtn、lkevinzc、caojilin、ラクシャ、フィエテ・ルーア、スルビ・ヴィジャイヴァルギーヤ、Muhyun Kim、dennismalmgren、adursun、Anirudh Dagar、liqingnz、ペドロ・ラロイ、lgov、ati-ozgur、ジュン・ウー、マティアス・ブルーメ、リン・ユアン、geogunow、ジョシュ・ガードナー、マクシミリアン兄弟、ラキブ・イスラム、レナード・ローゼン、Abhinav Upadhyay、rongruosong、スティーブ・セドルマイヤー、ルスラン・バラトフ、ラファエル・シュラッター、liusy182、ジャンニス・パパス、ati-ozgur、abaza、dchoi77、アダム・ガーソン、Phic Le、マーク・アトウッド、クリスタベラ、vn09、海浜林、jjangga0214、リッチーチェン、ノエロ、ハンセント、ガール・ドップス、dvincent1337、whited3vil、ピーター・クリッツ、codypenta、joseppinilla、ahaurya、karolszk、heytitle、ピーター・ゲッツ、rigtorp、Tiep Vu、フィリップ、mlxd、Kale-ab Tessera、サンジャル・アディロフ、MatteoFerrara、hento、Katarzyna Biesialska、グレゴリー・ブラス、Duy—タン・ドーン、ポーローレル、グレイタウン、デュック・ファム、sl7423、ジェドン・ファン、イーダ・ワン、cys4、clhm、ジャン・カドゥール、austinmw、trebeljahr、tbaums、チョン・V・グエン、パベルコマロフ、valamal、NotAnotherSystem、J-Arun-Mani、ジャンシオ、eldarkurtic、the-great-shazbot、ドクターコロッサス、グドゥシャルム、クラウス、ダニエル・ミッチェン、ホノース、ビアージー om, abhinavsp0730, jonathanhrandall, イスラエル, ノダール・オクロシアシビリ, guurKap, ジヤン・カン, スティーブンジョーク,トマー・カフタン、liweiwp、netyster、ypandya、nishantTharani、heiligerl、sportsThu、ホア・グエン、manuel-arno-korfmann-webentwicklung、aterzis-Personal、nxby、Xiaoting He、ジョサイア・ヨーダー、数学研究、mzz2017、jroberayalas u、ghejc、bsharmi、vkramdev、simonwardjones、lakshkD、talneOran、djliden、Nikhil95、Orenバルカン、guoweis、haozhu233、pratikhack、Yue Ying、tayfununal、steinsag、charleybeller、アンドリューLumsdaine、Jiekui Zhang、ディーパックPathak、フロリアン・ドンハウザー、ティム・ゲイツ、アドリアン・タイセリング、ロン・メディナ、ガウラフ・サハ、ミュラ・セメルシ、レイマオ、リーバイ・マクレニー、ジョシュア・ブロイド、jake221、jonally、zyhazwraith、ブライアン・パルファー、ニックトマシノ、レファン・チャン、ホンシェン・ヤン、ヴィニー・カヴァロ、ユンタイ、ユアンシャン・チュー、アマラゾフ、パストリチャ、ベン・グリナワルド、シヴァム・ウパディー、クアンシャンゼ・ドゥ、ビスワジット・サフー、パルテ・パンディット、イシャン・クマール、ホムンクルスク、レーン・シュワルツ、バラグンジャル、ジェイソンウィーナー, アーミン・ゴラムポール, Shreshtha13, eigen-arnav, キム・ヒョンギュー, EmilYong,Bálint Mucsányi、チェイス・デュボア。 

アマゾンウェブサービス、特にスワミ・シヴァスブラマニアン、ピーター・デサンティス、アダム・セリプスキー、アンドリュー・ジャシーがこの本の執筆に寛大な支援をしてくれたことに感謝します。利用可能な時間、リソース、同僚との議論、継続的な励ましなしには、この本は実現しなかったでしょう。 

## [概要

* ディープラーニングはパターン認識に革命をもたらし、コンピュータービジョン、自然言語処理、自動音声認識などの幅広いテクノロジーを強化するテクノロジーを導入しました。
* ディープラーニングをうまく適用するには、問題のキャスト方法、モデリングの数学、モデルをデータにあてはめるアルゴリズム、そしてそれをすべて実装するためのエンジニアリング手法を理解する必要があります。
* 本書は、散文、図、数学、コードを含む包括的なリソースをすべて1か所にまとめたものです。
* この本に関する質問に答えるには、https://discuss.d2l.ai/ のフォーラムにアクセスしてください。
* すべてのノートブックは GitHub からダウンロードできます。

## 演習

1. この書籍 [discuss.d2l.ai](https://discuss.d2l.ai/) のディスカッションフォーラムにアカウントを登録してください。
1. Python をコンピューターにインストールします。
1. セクションの下部にあるリンクからフォーラムにアクセスしてください。フォーラムでは、著者やより広範なコミュニティに参加することで、ヘルプを探したり、本について議論したり、質問に対する答えを見つけることができます。

:begin_tab:`mxnet`
[Discussions](https://discuss.d2l.ai/t/18)
:end_tab:

:begin_tab:`pytorch`
[Discussions](https://discuss.d2l.ai/t/20)
:end_tab:

:begin_tab:`tensorflow`
[Discussions](https://discuss.d2l.ai/t/186)
:end_tab:
